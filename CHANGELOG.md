### 20. IIS 핸들러 및 진단 로직 수정 (2025-09-14)

*   **IIS 핸들러 설정 스크립트 개선 (`install_applications.ps1`):**
    *   **문제:** IIS 핸들러 추가 시, 이미 핸들러가 존재할 경우 "중복된 컬렉션 항목" 오류가 발생했습니다. 또한, 특정 PowerShell 환경에서 `Remove-WebConfiguration` cmdlet을 인식하지 못하는 문제가 있었습니다.
    *   **해결책:** 핸들러를 추가하기 전에 `Remove-WebConfigurationProperty`를 사용하여 기존 핸들러를 먼저 제거하도록 수정하여 스크립트의 멱등성을 보장하고, 호환성 문제를 해결했습니다. 또한, 모든 웹 사이트를 순회하며 핸들러를 적용하도록 로직을 개선했습니다.
*   **W-18 진단 스크립트 수정 (`W-18_IIS_DB_Connection_Vulnerability_Check.ps1`):**
    *   **문제:** `.asa` 확장자에 대한 취약한 핸들러 매핑을 탐지하는 로직이 불안정하여 정확한 진단이 이루어지지 않았습니다.
    *   **해결책:** `Get-WebConfigurationProperty`를 사용하여 모든 핸들러를 가져온 후, `Where-Object`로 필터링하는 안정적인 방식으로 로직을 수정하여 취약점을 정확하게 탐지하도록 개선했습니다.
*   **진단 로그 기능 추가 및 개선 (`run_all_diagnostics.ps1`):**
    *   **내용:** 모든 진단 과정의 출력을 `logs` 디렉토리에 파일로 저장하는 기능을 추가했습니다. `Start-Transcript`를 사용하여 전체 과정을 기록합니다.
    *   **개선:** 로그 파일에 암호와 같은 민감한 정보가 평문으로 기록되는 문제를 해결하기 위해, 스크립트 종료 후 로그 파일을 읽어 암호를 `********`로 마스킹하는 로직을 추가했습니다.
    *   **수정:** 스크립트 내에 `Start-Transcript` 및 `Stop-Transcript`가 중복으로 호출되어 발생하던 오류를 수정했습니다.