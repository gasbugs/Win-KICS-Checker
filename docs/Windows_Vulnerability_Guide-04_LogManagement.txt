W-34 (상) 4. 로그 관리 > 4.1 로그의 정기적 검토 및 보고
취약점 개요
점검내용  로그의 정기적 검토 및 보고 여부 점검
점검목적
 정기적인 로그 점검을 통해 안정적인 시스템 상태 유지 및 외부 공격 여부
를 파악하기 위함
보안위협
 로그의 검토 및 보고 절차가 없는 경우 외부 침입 시도에 대한 식별이 누락
될 수 있고, 침입 시도가 의심되는 사례 발견 시 관련 자료를 분석하여 해당
장비에 대한 접근을 차단하는 등의 추가 조치가 어려움
참고
※ 시스템 접속 기록, 계정 관리 로그 등 W-69(중) 점검 항목에서 설정한 보안 로그를 포
함하여 응용 프로그램, 시스템 로그 기록에 대하여 주기적인 검토 및 보고가 필요함
※ 관련 점검 항목 : A-85(하), W-69(중)
점검대상 및 판단기준
대상  Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : 접속기록 등의 보안 로그, 응용 프로그램 및 시스템 로그 기록에 대해 정기
적으로 검토, 분석, 리포트 작성 및 보고 등의 조치가 이루어지는 경우
취약 : 위 로그 기록에 대해 정기적으로 검토, 분석, 리포트 작성 및 보고 등의 조
치가 이루어 지지 않는 경우
조치방법 로그 기록 검토 및 분석을 시행하여 리포트를 작성하고 정기적으로 보고함
점검 및 조치 사례
■ Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
Step 1) 로그 기록에 대한 정기적 검토 및 분석 실시
(1) 시작> 제어판> 관리 도구> 이벤트 뷰어
(2) 응용 프로그램 로그, 보안 로그, 시스템 로그 분석
※ OS 구성에 따라 디렉토리 서비스 로그, 파일 복제 서비스 로그, DNS 서버 로그 등 분석
Step 2) 로그 분석 결과에 대한 일일·월간 보고서 작성 및 보고
조치 시
영향
일반적인 경우 영향 없음
􀀕􀀖􀀔
---
W-35 (상) 4. 로그 관리 > 4.2 원격으로 액세스 할 수 있는 레지스트리 경로
취약점 개요
점검내용  원격 레지스트리 서비스 사용 여부 점검
점검목적
 원격 레지스트리 서비스를 비활성화 하여 레지스트리에 대한 원격 접근을
차단하기 위함
보안위협
 원격 레지스트리 서비스는 액세스에 대한 인증이 취약하여 관리자 계정 외
다른 계정들에게도 원격 레지스트리 액세스를 허용할 우려가 있으며, 레지스
트리에 대한 권한설정이 잘못되어 있는 경우 원격에서 레지스트리를 통해
임의의 파일을 실행 할 우려가 있음
 레지스트리 서비스의 장애는 전체 시스템에 영향을 줄 수 있어 서비스거부
공격(DoS) 공격에 이용될 수 있음
참고
※ 레지스트리: 윈도우를 실행하는데 필요한 모든 환경설정 데이터를 모아 두는 중앙 저장소
※ 원격 레지스트리 서비스: 원격지에 있는 컴퓨터를 한 곳에서 집중관리하기 위한 목적
으로 원격 컴퓨터의 레지스트리에 접근할 수 있도록 하는 서비스
점검대상 및 판단기준
대상  Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : Remote Registry Service가 중지되어 있는 경우
취약 : Remote Registry Service가 사용 중인 경우
조치방법 불필요 시 서비스 중지 및 사용 안 함으로 설정
점검 및 조치 사례
■ Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
Step 1) 시작> 실행> SERVICES.MSC> Remote Registry> 속성
Step 2) 시작 유형 → 사용 안 함
Step 3) 서비스 상태 → 중지
조치 시
영향
Remote Registry Service를 사용하는지 확인 필요
(서비스> Remote Registry Service> 등록 정보> 종속성 참고)
􀀕􀀖􀀕
---
W-70 (하) 4. 로그 관리 > 4.3 이벤트 로그 관리 설정
취약점 개요
점검내용  이벤트 로그 파일 용량 및 보관 기간 설정 점검
점검목적
 유사 시 책임추적을 위해 주요 이벤트가 누락되지 않도록 이벤트 로그 파일
의 크기 및 보관 기간을 적절하게 유지하기 위함
보안위협
 이벤트 로그 파일의 크기가 충분하지 않을 경우 중요 로그가 저장되지 않을
위험이 있으며, 최대 보존 크기를 초과하는 경우 자동으로 덮어 씀으로써 중
요 로그의 손실의 우려가 있음
참고 -
점검대상 및 판단기준
대상  Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : 최대 로그 크기 “10,240KB 이상”으로 설정, “90일 이후 이벤트 덮어씀”
을 설정한 경우
취약 : 최대 로그 크기 “10,240KB 미만”으로 설정, 이벤트 덮어씀 기간이 “90일
이하”로 설정된 경우
조치방법 최대 로그 크기 “10,204KB”, “90일 이후 이벤트 덮어씀” 설정
점검 및 조치 사례
■ Windows NT
Step 1) 프로그램> 관리 도구> 이벤트 표시기> 로그> 로그 설정
Step 2) 최대 로그 크기 → 10240KB
다음 이전의 이벤트 겹쳐 씀 → 90일
---
W-70 (하) 4. 로그 관리 > 4.3 이벤트 로그 관리 설정
■ Windows 2000, 2003, 2008, 2012, 2016, 2019
Step 1) 시작> 실행> EVENTVWR.MSC> 해당 로그> 속성> 일반
Step 2) 최대 로그 크기 → 10240KB
최대 로그 크기에 도달할 때: 다음보다 오래된 이벤트 덮어쓰기 → 90일
[Windows 2000, 2003]
[Windows 2008, 2012, 2016, 2019]
※ Windows 2008, 2012, 2016, 2019 서버의 경우 덮어쓰기 날짜 지정 
---
W-71 (중) 4. 로그 관리 > 4.4 원격에서 이벤트 로그 파일 접근 차단
취약점 개요
점검내용  원격에서 로그 파일의 접근을 차단하기 위한 권한 적절성 점검
점검목적
 원격에서 로그 파일을 접근하는 것을 차단하여 로그 파일의 훼손 및 변조를
차단하기 위함
보안위협
 원격 익명 사용자의 시스템 로그 파일에 접근이 가능한 경우 ‘중요 시스템
로그’ 파일 및 ‘애플리케이션 로그’ 등 중요 보안 감사 정보의 변조·삭제·유출
의 위험이 존재
참고
※ 로그 디렉토리 위치
• 시스템 로그 디렉토리: %systemroot%\system32\config
• IIS 로그 디렉토리: %systemroot%\system32\LogFiles
점검대상 및 판단기준
대상  Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : 로그 디렉토리의 접근권한에 Everyone 권한이 없는 경우
취약 : 로그 디렉토리의 접근권한에 Everyone 권한이 있는 경우
조치방법 로그 디렉토리의 접근권한에 Everyone 제거
점검 및 조치 사례
■ Windows NT, 2000, 2003, 2008, 2012
Step 1) 탐색기> 로그 디렉토리> 속성> 보안
Step 2) Everyone 권한 제거
■ Windows 2016, 2019
Step 1) 탐색기> 로그 디렉토리> 속성> 보안> 고급
Step 2) Everyone 권한 제거
※ 일반적으로 시스템 로그는C:\winnt\system32\config 파일에 저장되지만. 애플리케이션 로
그 파일은 각각의 애플리케이션마다 로그 저장 위치가 다름. 웹 서버에 많이 사용하는 IIS
경우, C:\winnt\system32\LogFiles에 저장됨.