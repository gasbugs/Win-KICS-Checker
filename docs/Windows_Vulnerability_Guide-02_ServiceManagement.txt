---
W-7 (상) 2. 서비스 관리 > 2.1 공유 권한 및 사용자 그룹 설정
취약점 개요
점검내용  공유 디렉토리 내 Everyone 권한 존재 여부 점검
점검목적
 디폴트 공유인 C$, D$, Admin$, IPC$ 등을 제외한 공유 폴더에 Everyone
그룹으로 공유되는 것을 금지하여 익명 사용자의 접근을 차단하기 위함
보안위협
 Everyone이 공유계정에 포함되어 있으면 익명 사용자의 접근이 가능하여 내
부 정보 유출 및 악성코드의 감염 우려가 있음
참고 -
점검대상 및 판단기준
대상  Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : 일반 공유 디렉토리가 없거나 공유 디렉토리 접근 권한에 Everyone 권
한이 없는 경우
취약 : 일반 공유 디렉토리의 접근 권한에 Everyone 권한이 있는 경우
조치방법 공유 디렉토리 접근 권한에서 Everyone 권한 제거 후 필요한 계정 추가
점검 및 조치 사례
■ Windows NT
Step 1) 프로그램> 관리도구> 서버 관리자> 컴퓨터> 공유 디렉토리> 등록정보> 사용 권한에
서 Everyone 으로 된 공유를 제거하고 접근이 필요한 계정의 적절한 권한 추가
■ Windows 2000, 2003, 2008, 2012, 2016, 2019
Step 1) 시작> 실행> FSMGMT.MSC> 공유
Step 2) 사용 권한에서 Everyone 으로 된 공유를 제거하고 접근이 필요한 계정의 적절한 권한
추가
---
W-8 (상) 2. 서비스 관리 > 2.2 하드디스크 기본 공유 제거
취약점 개요
점검내용  하드디스크 기본 공유 제거 여부 점검
점검목적  하드디스크 기본 공유를 제거하여 시스템 정보 노출을 차단하고자 함
보안위협
 Windows는 프로그램 및 서비스를 네트워크나 컴퓨터 환경에서 관리하기 위
해 시스템 기본 공유 항목을 자동으로 생성함. 이를 제거하지 않으면 비인가
자가 모든 시스템 자원에 접근할 수 있는 위험한 상황이 발생할 수 있으며
이러한 공유 기능의 경로를 이용하여 바이러스가 침투될 수 있음
참고
※ 기본 공유: 관리목적으로 자동 생성되는 공유 드라이브(Administrative share). 이러한
드라이브들은 C$, D$, E$ 등과 같이 이름 뒤에 $가 붙어서 숨겨진 공유로 처리되며,
Windows 2000, XP에서는 관리자 ID와 Password를 알고 있으면 네트워크를 통해 이러
한 공유 드라이브들에 자유롭게 접근할 수 있음. 그러나 이후 버전 Windows에서는 보
안상의 이유로 로컬시스템의 관리자가 네트워크를 통해 시스템을 관리하지 못하도록
기본적으로 차단됨
점검대상 및 판단기준
대상  Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : 레지스트리의 AutoShareServer (WinNT: AutoShareWks)가 0이며 기본
공유가 존재하지 않는 경우
취약 : 레지스트리의AutoShareServer (WinNT: AutoShareWks)가 1이거나 기본
공유가 존재하는 경우
조치방법 기본 공유 중지 후 레지스트리 값 설정(IPC$, 일반 공유 제외)
점검 및 조치 사례
■ Windows NT
Step 1) 프로그램> 관리도구> 서버 관리자> 컴퓨터> 공유 디렉토리> 공유
■ Windows 2000, 2003, 2008, 2012, 2016, 2019
Step 1) 시작> 실행> FSMGMT.MSC> 공유> 기본 공유 선택> 마우스 우클릭> 공유 중지
Step 2) 시작> 실행> REGEDIT
아래 레지스트리 값을 0으로 수정함(키 값이 없을 경우 새로 생성함)
"HKLM\SYSTEM\CurrentControlSet\Services\lanmanserver\parameters\AutoShareS
erver”(Windows NT일 경우: AutoShareWks)
※ 방화벽과 라우터에서 135~139(TCP/UDP)포트를 차단하여 외부로부터의 위험을 제거함으로
써 보안성을 높일 수 있음 (Windows 2008 제외)
---
W-9 (상) 2. 서비스 관리 > 2.3 불필요한 서비스 제거
취약점 개요
점검내용  불필요한 서비스 가동 여부 점검
점검목적
 사용자 환경에 필요하지 않은 서비스 및 실행 파일을 제거하거나 비활성화
처리하여 이를 통한 악의적인 공격을 차단하기 위함
보안위협
 시스템에 기본적으로 설치되는 불필요한 취약 서비스들이 제거되지 않은 경
우, 해당 서비스의 취약점으로 인한 공격이 가능하며, 네트워크 서비스의 경
우 열린 포트를 통한 외부 침입의 가능성이 존재함
참고
※ OS 버전에 따라 ‘일반적으로 불필요한 서비스’ 목록에 나열된 서비스가 제공되지 않을 수
있음
점검대상 및 판단기준
대상  Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : 일반적으로 불필요한 서비스(아래 목록 참조)가 중지되어 있는 경우
취약 : 일반적으로 불필요한 서비스(아래 목록 참조)가 구동 중인 경우
조치방법 서비스 중지 후 “사용 안 함” 설정
점검 및 조치 사례
■ Windows NT
Step 1) 시작> 설정> 제어판> 서비스를 선택하여 불필요한 서비스를 중지하고, 시작 옵션에
서 "시작 유형"을 "사용 안함"으로 수정
Step 2) 해당 서비스를 선택하고 오른쪽 메뉴에서 "시작 옵션"을 클릭하면 시스템이 시작할
때에 해당 서비스의 시작 유형을 선택할 수 있음. 만약, 시스템 시작 시 자동으로 시
작되게 하려면 [자동], 수동으로 서비스를 시작하려면 [수동], 서비스 자체를 사용하지
않으려면 [사용 안함]을 선택한 후 [확인]을 클릭함
■ Windows 2000, 2003, 2008, 2012, 2016, 2019
Step 1) 시작> 실행> SERVICES.MSC> "해당 서비스" 선택> 속성
Step 2) 시작 유형 -> 사용 안 함
Step 3) 서비스 상태 -> 중지 설정
특별한 목적을 위해 사용하는 서비스가 아니라면 시스템의 업무에 부합되는 서비스가 아닌 기
타 디폴트 서비스를 사용하지 않는 것이 좋으며, 시스템 관리자는 대상 시스템의 용도를 정확
히 파악해 불필요한 서비스를 제거하여야 함

서비스 시작 유형 설 명
사용 안 함 설치되어 있으나 실행되지 않음
수동 다른 서비스나 응용 프로그램에서 해당 기능을 필요로 할 때만 시작됨
자동 부팅 시에 해당 장치 드라이버가 로드된 후에 운영 체제에 의해 시작됨
---
W-9 (상) 2. 서비스 관리 > 2.3 불필요한 서비스 제거
각 서비스마다 옵션을 설정할 수 있으며 해당 서비스를 선택하고 더블 클릭하게 되면 시작 유
형을 선택할 수 있으며 시작 시 로그온 계정을 별도로 설정할 수 있음. 만약, 시스템 시작 시
자동으로 시작되게 하려면 [자동], 수동으로 서비스를 시작하려면 [수동], 서비스 자체를 사용
하지 않으려면 [사용 안 함]을 선택한 후 [확인]을 클릭함
※ 일반적으로 불필요한 서비스

서비스명 기능 및 설명
Alerter 네트워크상에서 사용자와 컴퓨터에 관리용 경고메시지를 전송하는 기능
Automatic Updates
중요한 윈도우 업데이트를 다운로드하고 설치할 수 있도록 하는 애플리케
이션. 수동패치를 적용하거나, MS패치 관리 서버로 패치를 일괄적으로 관
리하는 경우 불필요한 서비스
Clipbook 서버 내 Clipbook을 다른 클라이언트와 공유
Computer Browser 네트워크에 있는 모든 컴퓨터의 목록을 업데이트 하고 관리하는 기능
Cryptographic
Services
윈도우 파일의 서명을 확인하는 카탈로그 데이터베이스 서비스를 총괄
DHCP Client
IP 주소와 DNS 이름을 DHCP 서버에 등록하거나 DHCP 서버로부터 동적으
로 IP주소를 가져오는 기능을 수행. 단독으로 시스템을 수행하며 고정IP를
사용하는 경우 불필요한 서비스
Distributed Link
Tracking Client,
Server
네트워크 도메인의 여러 컴퓨터나 일반컴퓨터에서 NTFS 파일간의 연결을
관리하는 도구. Active Directory가 구성되어 있지 않은 서버에서는 불필요
한 서비스.
DNS Client
컴퓨터에 대한 도메인 이름 시스템(DNS)이름을 확인하고 캐시에 보관하는
기능. DNS 서버가 아닌 시스템에서는 유명무실하나, IPSEC을 사용하는 경
우 필요한 경우 있음
Error reporting
Service
프로그램 오류가 시 응용프로그램의 오류를 MS에 보고한다는 내용을 표시
하는 기능
Human Interface
Device Access
키보드 또는 기타 멀티미디어 장치에 사전 정의된 버튼들을 사용하는 HID
장치들을 위한 서비스
IMAPI CD-Burning
COM Service
서버에 CD-RW 또는 DVD-RW가 장착되어 보조백업장치 역할을 하기 위해
서 자체 레코딩 백업을 할 수 있음
Messenger 클라이언트와 서버 사이에 netsend 및 경고서비스 메시지를 전송하는 기능
NetMeeting Remote
Desktop Sharing
윈도우9X 운영체제부터 인증된 사용자가 넷미팅을 사용해서 원격으로 컴퓨
터에 접근할 수 있도록 하는 기능
Portable Media
Serial Number
컴퓨터에 연결된 이동성 음악연주기(미디기기)의 등록번호를 복원하는 기능
Print Spooler
인쇄 과정에 있는 스풀링을 관리하는 서비스. 프린터가 있는 경우 필수 서
비스이나, 프린터가 연결되지 않은 시스템에서는 불필요함
Remote Registry
원격 사용자가 이 컴퓨터에서 레지스트리 설정을 수정할 수 있도록 설정
하는 애플리케이션
Simple TCP/IP
Services
Echo, Discard, Character Generator, Daytime, Quote of the Day 지원
Wireless Zero
Configuration
802.11 어댑터에 대해 자동 구성을 공급하는 기본적인 도구
운영중인 시스템에서 필수 서비스를 정의하는 것은 매우 복잡한 과정으로 서비스 사용 여부는
시스템의 영향성을 고려하여 신중하게 평가되어야 하므로 Microsoft에서 권고하는 가이드에
따라 전략적으로 적용하여야 함
※ https://technet.microsoft.com/ko-kr/library/dd547941.aspx (서비스 및 서비스 계정 보안 계획
가이드) 참고
윈도우 시스템 설치 시 기본적으로 설치되는 서비스에 대한 상세 설명은 아래 주소 참조
https://technet.microsoft.com/ko-kr/library/dd547949.aspx

---
W-10 (상) 2. 서비스 관리 > 2.4 IIS 서비스 구동 점검
취약점 개요
점검내용  불필요한 IIS 서비스 구동 여부 점검
점검목적
 불필요한 IIS 서비스가 구동 상태인지를 점검하여 제거하고, 해당 서비스가
취약점이 제거되지 않은 상태로 외부 위협에 노출되지 않도록 하기 위함
보안위협
 IIS 서비스는 WEB, FTP 등의 서비스를 제공해주는 유용한 서비스이나 프로파
일링, 서비스 거부, 불법적인 접근, 임의의 코드실행, 정보 공개, 바이러스, 웜,
트로이목마 등의 위협에 노출될 수 있어 서비스 불필요 시 삭제하여야 함
참고
※ 일반적으로 불필요한 서비스가 시스템 내 구동되고 있는 경우에는 관리되지 않은 상
태로 방치되는 경우가 많아 보안 취약점이 그대로 노출되어 악의적인 공격의 대상이
될 수 있음
점검대상 및 판단기준
대상  Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : IIS 서비스가 필요하지 않아 이용하지 않는 경우
취약 : IIS 서비스를 필요하지 않지만 사용하는 경우
조치방법 IIS 서비스를 사용하지 않는 경우 IIS 서비스 중지
점검 및 조치 사례
■ Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
Step 1) 시작> 실행> SERVICES.MSC> IISADMIN> 속성> "시작 유형"을 "사용 안 함" 설정 후 중지
※ IIS 가 설치되어 있지 않을 경우 SERVICES.MSC 에서 보이지 않음
---
W-11 (상) 2. 서비스 관리 > 2.5 디렉토리 리스팅 제거
취약점 개요
점검내용  웹서버 디렉토리 리스팅 차단 설정 여부 점검
점검목적
 웹서버 특정 폴더에 대한 디렉토리 리스팅 취약점을 제거하여, 불필요한 파
일 정보 노출을 차단하기 위함
보안위협
 웹서버에 디렉토리 리스팅이 제거되지 않은 경우 외부에서 디렉토리 내에
보유하고 있는 모든 파일 목록 확인 및 파일에 대한 접근이 가능하여 주요
정보의 유출의 가능성이 있음
참고
※ 디렉토리 리스팅 취약점: 디렉토리에 대한 요청 시 기본 페이지가 호출되어 사용자에
게 전송하지만, 기본 페이지가 존재하지 않는 경우 디렉토리 내에 존재하는 모든 파일
의 목록을 보여주는 취약점
점검대상 및 판단기준
대상  Windows 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : “디렉토리 검색” 체크하지 않음
취약 : “디렉토리 검색” 체크함
※ 조치 시 마스터 속성과 모든 사이트에 적용함
조치방법 사용하지 않는 경우 IIS 서비스 중지, 사용할 경우 디렉토리 검색 체크 해제
점검 및 조치 사례
■ Windows 2000(IIS 5.0), 2003(IIS 6.0)
Step 1) 시작> 실행> INETMGR> 웹 사이트> 속성> 홈 디렉토리
Step 2) "디렉토리 검색" 체크 해제
■ Windows 2008(IIS 7.0), 2012(IIS 8.0), 2016(IIS 10.0), 2019(IIS 10.0)
Step 1) 제어판> 관리도구> 인터넷 정보 서비스(IIS) 관리> 해당 웹 사이트> IIS> "디렉토리
검색" 선택 후 "사용 안 함" 선택
---
W-12 (상) 2. 서비스 관리 > 2.6 IIS CGI 실행 제한
취약점 개요
점검내용  IIS CGI 실행 제한 설정 여부 점검
점검목적
 CGI 스크립트를 정해진 디렉토리에서만 실행되도록 하여 악의적인 파일의
업로드 및 실행을 방지하기 위함
보안위협
 게시판이나 자료실과 같이 업로드 되는 파일이 저장되는 디렉토리에 CGI 스
크립트가 실행 가능한 경우 악의적인 파일을 업로드하고 이를 실행하여 시
스템의 중요 정보가 노출될 수 있으며 침해사고의 경로로 이용될 수 있음.
참고
※ CGI(Common Gateway Interface): 사용자가 서버로 보낸 데이터를 서버에서 작동중인
데이터처리프로그램에 전달하고, 여기에서 처리된 데이터를 다시 서버로 되돌려 보내
는 등의 일을 하는 프로그램
※ 일반적으로 기본 CGI 디렉토리(C:\inetpub\scripts)는 사용하지 않음
점검대상 및 판단기준
대상  Windows 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : 해당 디렉토리 Everyone에 모든 권한, 수정 권한, 쓰기 권한이 부여되지
않은 경우
취약 : 해당 디렉토리 Everyone에 모든 권한, 수정 권한, 쓰기 권한이 부여되어
있는 경우
※ 조치 시 마스터 속성과 모든 사이트에 적용함
조치방법
사용하지 않는 경우 IIS 서비스 중지, 사용할 경우 Everyone에 모든 권한, 수정
권한, 쓰기 권한 제거 후 Administrators, System 그룹 추가(모든 권한)
점검 및 조치 사례
■ Windows 2000(IIS 5.0), 2003(IIS 6.0), 2008(IIS 7.0), 2012(IIS 8.0), 2016(IIS 10.0), 2019(IIS 10.0)
Step 1) 탐색기> 해당 디렉토리> 속성> 보안 (기본 CGI 디렉토리 위치 C:\inetpub\scripts)
Step 2) Everyone 의 모든 권한, 수정 권한, 쓰기 권한 제거
※ IIS 초기 구축시에는 scripts 폴더가 생성되지 않을 수 있음
---
W-13 (상) 2. 서비스 관리 > 2.7 IIS 상위 디렉토리 접근 금지
취약점 개요
점검내용  IIS 상위 디렉토리 접근 금지 설정 적용 여부 점검
점검목적
 “..” 와 같은 웹서버 상에서 상위 경로를 사용하지 못하도록 설정하여
Unicode 버그 및 서비스 거부 공격에 이용당하지 않도록 하기 위함
보안위협
 이용자가 상위경로로 이동하는 것이 가능할 경우 하위경로에서 상위로 접근
하며 정보 탐색이 가능하여 중요 정보가 노출될 가능성이 존재함
참고
※ “..” 는 unicode 버그, 서비스 거부와 같은 공격에 쉽게 이용되므로 허용하지 않는 것
을 권장함
점검대상 및 판단기준
대상  Windows 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : 상위 디렉토리 접근 기능을 제거한 경우
취약 : 상위 디렉토리 접근 기능을 제거하지 않은 경우
※ 조치 시 마스터 속성과 모든 사이트에 적용함
조치방법 사용하지 않는 경우 IIS 서비스 중지, 사용할 경우 상위 디렉토리 접근 기능 제거
점검 및 조치 사례
■ Windows 2000(IIS 5.0), 2003(IIS 6.0)
Step 1) 인터넷 정보 서비스(IIS) 관리> 해당 웹사이트> 속성> 홈디렉토리> 구성> [옵션] 탭
에서 "부모 경로 사용" 의 체크박스 해제 확인
■ Windows 2008(IIS 7.0), 2012(IIS 8.0), 2016(IIS 10.0), 2019(IIS 10.0)
Step 1) 제어판> 관리도구> 인터넷 정보 서비스(IIS) 관리자> 해당 웹사이트> IIS> ASP 선택,
"부모 경로 사용" 항목 "False" 설정 확인
---
W-14 (상) 2. 서비스 관리 > 2.8 IIS 불필요한 파일 제거
취약점 개요
점검내용  IIS 설치 시 기본적으로 제공되는 불필요한 파일 제거 여부 점검
점검목적
 IIS 서비스 설치 시 기본으로 설치되는 예제 스크립트, 설명서, 샘플 애플리
케이션, 디렉토리 등 서비스에 불필요한 IIS 모듈을 제거하여 불필요한 공격
대상으로 이용되는 것을 방지하기 위함
보안위협
 IIS 서비스 설치 시 기본적으로 제공 되는 파일 및 디렉토리를 제거하지 않
을 경우, 해당 파일들로 인해 공격 대상으로 이용되거나 백도어가 심어질 위
험이 존재함
참고 -
점검대상 및 판단기준
대상  Windows 2000, 2003
판단기준
양호 : 해당 웹 사이트에 IISSamples, IISHelp 가상 디렉토리가 존재하지 않는
경우
취약 : 해당 웹 사이트에 IISSamples, IISHelp 가상 디렉토리가 존재하는 경우
※ 조치 시 마스터 속성과 모든 사이트에 적용함
조치방법 사용하지 않는 경우 IIS 서비스 중지, 사용할 경우 가상 디렉토리 삭제
점검 및 조치 사례
■ Windows 2000(IIS 5.0), 2003(IIS 6.0)
Step 1) Sample 디렉토리 확인 후 삭제함
c:\inetpub\iissamples
c:\winnt\help\iishelp (IIS 설명서)
c:\program files\common files\system\msadc\sample (데이터 액세스)
%SystemRoot%\System32\Inetsrv\IISADMPWD
※ IIS 7.0(Windows 2008) 이상 버전 해당 사항 없음
---
W-15 (상) 2. 서비스 관리 > 2.9 웹 프로세스 권한 제한
취약점 개요
점검내용  웹 프로세스 권한 제한 설정 여부 점검
점검목적
 웹 프로세스가 웹 서비스 운영에 필요한 최소한의 권한만을 갖도록 제한하
여 웹사이트 방문자가 웹 서비스의 취약점을 이용해 시스템에 대한 어떤 권
한도 획득할 수 없도록 하기 위함
보안위협
 웹 프로세스 권한을 제한하지 않은 경우 웹 사이트 방문자가 웹 서비스의
취약점을 이용하여 시스템 권한을 획득할 수 있으며, 웹 취약점을 통해 접속
권한을 획득한 경우에는 관리자 권한을 획득하여 서버에 접속 후 정보의 변
경, 훼손 및 유출 할 우려가 있음
참고
※ 참고로 최소 권한의 계정으로 IIS를 구동 시키는 것 이외에 ‘웹 사이트 등록정보’ > ‘홈
디렉토리’ > 응용프로그램 보호(IIS 프로세스 권한 설정)에서도 프로세스 권한을 설정할
수 있음 (점검 및 조치 사례 하단 참조)
점검대상 및 판단기준
대상  Windows NT, 2000, 2003, 2008, 2012, 2106, 2019
판단기준
양호 : 웹 프로세스가 웹 서비스 운영에 필요한 최소한 권한으로 설정되어 있는 경우
취약 : 웹 프로세스가 관리자 권한이 부여된 계정으로 구동되고 있는 경우
조치방법
시작> 제어판> 관리 도구> 로컬 보안 정책에서 nobody 계정 설정
2008 R2 (IIS 7.5) 이상은 Default로 ApplicationPoolIdentity가 적용되어 양호
점검 및 조치 사례
■ Windows NT, 2000, 2003
Step 1) 시작> 제어판> 관리도구> 컴퓨터 관리> 로컬 사용자 및 그룹> 사용자 선택
Step 2) nobody 계정 추가(nobody 계정의 소속 그룹에 정해진 User가 있으면 제거)
Step 3) 시작> 제어판> 관리도구> 로컬 보안 정책> 로컬 정책> 사용자 권한 할당 선택, "서
비스 로그온"에 "nobody" 계정 추가
Step 4) 시작> 실행> SERVICES.MSC> IIS Admin Service> 속성> [로그온] 탭의 계정 지정에
nobody 계정 및 패스워드 입력
Step 5) 시작> 프로그램> 윈도우 탐색기> IIS 가 설치된 폴더 속성> [보안] 탭에서 nobody
계정을 추가하고 모든 권한 체크
※ ‘웹 사이트 등록정보’ > ‘홈 디렉토리 > 응용프로그램 보호(IIS 프로세스 권한 설정)
 낮음(IIS 프로세스): IIS 프로세스는 시스템 권한을 가짐
 보통(풀링됨): IIS 프로세스를 실행과 동시에 일반 권한의 계정으로 권한 강하(falling)
 높음(격리됨): IIS 프로세스를 Guest 권한에 준하는 권한으로 실행시킴
세 가지 권한 중 '낮음‘으로 되어 있는 경우, IIS 프로세스는 시스템 권한을 가지게 되므
로 해커가 IIS 프로세스의 권한을 획득하면 관리자에 준하는 권한을 가질 수 있으므로 주
의 해야 함
■ Windows 2008(IIS 7.0), 2012(IIS 8.5), 2016(IIS 10.0), 2019(IIS 10.0)
※ Windows 2008 R2 (IIS 7.5) 이상은 기본적으로 ApplicationPoolIdentity 권한이 적용되어 양호
Step 1) 제어판> 관리도구> 인터넷 정보 서비스(IIS) 관리자> 해당 웹사이트> 고급 설정> ’응
용프로그램 풀 이름(DefaultAppPool)‘ 확인
Step 2) 제어판> 관리도구> 인터넷 정보 서비스(IIS) 관리자> 응용 프로그램 풀> ’용용 프로그
램 풀 이름(DefaultAppPool)’ 선택> 고급 설정> ID> ApplicationPoolIdentity 선택
---
W-16 (상) 2. 서비스 관리 > 2.10 IIS 링크 사용금지
취약점 개요
점검내용  IIS 링크 사용금지 설정 여부 점검
점검목적
 웹 컨텐츠 디렉토리에서 다른 디렉토리나 파일들에 접근할 수 있는 심볼릭
링크, 별칭(aliases), 바로가기 등을 제거하여 허용하지 않은 경로의 접근을
차단하기 위함
보안위협
 접근을 허용한 웹 콘텐츠 디렉토리 내에 서버의 다른 디렉토리나 파일들에
접근할 수 있는 심볼릭 링크, aliases, 바로가기 등이 존재하는 경우 해당 링
크를 통해 허용하지 않은 다른 디렉토리에 액세스 할 수 있는 위험성 존재
참고 -
점검대상 및 판단기준
대상  Windows 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : 심볼릭 링크, aliases, 바로가기 등의 사용을 허용하지 않는 경우
취약 : 심볼릭 링크, aliases, 바로가기 등의 사용을 허용하는 경우
조치방법
등록된 웹 사이트의 홈 디렉토리에 있는 심볼릭 링크, aliases, 바로가기 파일
삭제
점검 및 조치 사례
■ Windows 2000(IIS 5.0), 2003(IIS 6.0)
Step 1) 인터넷 정보 서비스(IIS) 관리> 해당 웹사이트> 속성> [홈 디렉토리] 탭 선택> "로컬
경로"에서 홈 디렉토리 위치 확인
W-16 (상) 2. 서비스 관리 > 2.10 IIS 링크 사용금지
Step 2) 로컬 경로에 입력된 홈 디렉토리로 이동하여 바로가기 파일 삭제
■ Windows 2008(IIS 7.0), 2012(IIS 8.0), 2016(IIS 10.0), 2019(IIS 10.0)
Step 1) 제어판> 관리도구> 인터넷 정보 서비스(IIS) 관리자> 해당 웹사이트> 기본 설정> "실
제 경로"에서 홈 디렉토리 위치 확인
Step 2) 실제 경로에 입력된 홈 디렉토리로 이동하여 바로가기 파일 삭제
---
W-17 (상) 2. 서비스 관리 > 2.11 IIS 파일 업로드 및 다운로드 제한
취약점 개요
점검내용  IIS 파일 업로드 및 다운로드 제한 설정 여부 점검
점검목적
 기반시설 시스템은 파일의 업로드 및 다운로드를 원칙적으로 금지하나, 부득
이 파일의 업로드 및 다운로드 기능을 활용해야 하는 경우, 파일의 용량 제
한을 설정하여 보안성 유지 및 안정적인 웹서버 자원관리를 할 수 있도록
하기 위함
보안위협
 대용량 파일 업로드 및 다운로드가 가능한 경우 서버 리소스에 영향을 주어
서비스 장애가 발생할 수 있음
참고
※ IIS에서는 파일의 업로드 및 다운로드 기능을 직접적으로 차단하는 기능이 없어, 웹사
이트 내 파일의 업로드 및 다운로드 기능의 구현 여부의 병행 점검이 필요
점검대상 및 판단기준
대상  Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : 웹 프로세스의 서버 자원 관리를 위해 업로드 및 다운로드 용량을 제한
하는 경우
취약 : 웹 프로세스의 서버 자원을 관리하지 않는 경우 (업로드 및 다운로드 용량
미 제한)
조치방법 파일 업로드 및 다운로드 용량을 허용할 수 있는 최소 범위로 설정
점검 및 조치 사례
■ Windows NT, 2000, 2003
Step 1) 시작> 실행> SERVICES.MSC> IISADMIN> 속성> [일반] 탭에서 서비스 중지
Step 2) %systemroot%\system32\inetsrv\MetaBase.xml 파일을 찾아 편집기로 OPEN
Step 3) AspMaxRequestEntityAllowed 값을 찾아 파일 업로드 용량을 최소 범위로 제한
Step 4) AspBufferingLimit 값을 찾아 파일 다운로드 용량을 최소 범위로 제한
Step 5) 시작> 실행> SERVICES.MSC> IISADMIN> 속성> [일반] 탭에서 서비스 시작
■ Windows 2008, 2012, 2016, 2019
Step 1) 등록된 웹 사이트의 루트 디렉터리 디렉토리에 있는 web.config 파일 내 아래 항목
추가
(web.config 파일이 없으면 사이트 홈 디렉토리에 새로 생성)
[upload 및 download 용량 제한 - web.config 파일 편집]
Step 2) %systemroot% \system32 \inetsrv \config \applicationHost.config 파일 내 아래 항
목 추가
[upload 및 download 용량 제한 - applicationHost.config 파일 편집]
※ Default 설정 값
(1) maxAllowedContentLength (콘텐츠 용량) => Default: 30MB
(2) MaxRequestEntityAllowed (파일 업로드 용량) => Default: 200000 byte
(3) bufferingLimit (파일 다운로드 용량) => Default: 4MB(4194304 byte)

---
W-18 (상) 2. 서비스 관리 > 2.12 IIS DB 연결 취약점 점검
취약점 개요
점검내용  Global.asa 또는 별도의 DB 컨넥션을 하는 파일에 대한 취약점 점검
점검목적
 DB 컨넥션 파일(global.asa)에 대한 접근을 제한하여 SQL 서버의 사용자명과
패스워드와 같은 중요 정보의 노출을 차단하기 위함
보안위협
 global.asa 파일에는 데이터베이스 관련 정보(IP 주소, DB명, 패스워드), 내부
IP 주소, 웹 애플리케이션 환경설정 정보 및 기타 정보 등 보안상 민감한 내
용이 포함되어 있으므로 해당 파일이 악의적인 사용자에게 노출될 경우 침
해사고로 이어질 수 있음
참고
※ global.asa 파일: 각각의 ASP(Active Server Pages) 프로그램을 위해 IIS 서버상에서 관
리되는 파일. IIS 서버는 IIS 프로그램이 시작하고 정지할 때, 혹은 웹 클라이언트가
ASP 프로그램의 웹 페이지들을 액세스하는 브라우저 세션들을 시작하고 정지할 때 자
동적으로 global.asa 파일을 처리함
점검대상 및 판단기준
대상  Windows 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : .asa 매핑 시 특정 동작만 가능하도록 제한하여 설정한 경우 또는 매핑
이 없을 경우
취약 : .asa 매핑 시 모든 동작이 가능하도록 설정한 경우
조치방법
사용하지 않는 경우 IIS 서비스 중지, 사용할 경우 .asa 매핑을 아래 그림과 같
이 특정 동작만 가능하도록 추가(IIS 6.0) / asa 설정을 false 함(7.0, 8.0, 10.0)
점검 및 조치 사례
■ Windows 2000(IIS 5.0), 2003(IIS 6.0)
Step 1) asa 매핑 등록 확인
인터넷 정보 서비스(IIS) 관리자> 웹 사이트> 해당 웹 사이트> 속성> [홈 디렉토리]
탭에서 구성> [매핑] 탭 선택 후 .asa 매핑이 등록되어 있는지 확인
---
W-18 (상) 2. 서비스 관리 > 2.12 IIS DB 연결 취약점 점검
취약점 개요
점검내용  Global.asa 또는 별도의 DB 컨넥션을 하는 파일에 대한 취약점 점검
점검목적
 DB 컨넥션 파일(global.asa)에 대한 접근을 제한하여 SQL 서버의 사용자명과
패스워드와 같은 중요 정보의 노출을 차단하기 위함
보안위협
 global.asa 파일에는 데이터베이스 관련 정보(IP 주소, DB명, 패스워드), 내부
IP 주소, 웹 애플리케이션 환경설정 정보 및 기타 정보 등 보안상 민감한 내
용이 포함되어 있으므로 해당 파일이 악의적인 사용자에게 노출될 경우 침
해사고로 이어질 수 있음
참고
※ global.asa 파일: 각각의 ASP(Active Server Pages) 프로그램을 위해 IIS 서버상에서 관
리되는 파일. IIS 서버는 IIS 프로그램이 시작하고 정지할 때, 혹은 웹 클라이언트가
ASP 프로그램의 웹 페이지들을 액세스하는 브라우저 세션들을 시작하고 정지할 때 자
동적으로 global.asa 파일을 처리함
점검대상 및 판단기준
대상  Windows 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : .asa 매핑 시 특정 동작만 가능하도록 제한하여 설정한 경우 또는 매핑
이 없을 경우
취약 : .asa 매핑 시 모든 동작이 가능하도록 설정한 경우
조치방법
사용하지 않는 경우 IIS 서비스 중지, 사용할 경우 .asa 매핑을 아래 그림과 같
이 특정 동작만 가능하도록 추가(IIS 6.0) / asa 설정을 false 함(7.0, 8.0, 10.0)
점검 및 조치 사례
■ Windows 2000(IIS 5.0), 2003(IIS 6.0)
Step 1) asa 매핑 등록 확인
인터넷 정보 서비스(IIS) 관리자> 웹 사이트> 해당 웹 사이트> 속성> [홈 디렉토리]
탭에서 구성> [매핑] 탭 선택 후 .asa 매핑이 등록되어 있는지 확인
Step 2) asa 매핑 등록되어 있다면 특정 동작만 가능하도록 설정되어 있는지 확인
[매핑] 탭에서 [편집] 내용이 다음과 동일하게 설정되어 있는지 확인
- 동사> 다음으로 제한> GET, HEAD, POST, TRACE 입력
- 스크립트 엔진 체크
- 파일이 있는지 확인 체크
■ Windows 2008(IIS 7.0), 2012(IIS 8.0), 2016(IIS 10.0), 2019(IIS 10.0)
총 2가지 항목에서 확인 필요
2가지 항목이 모두 아래의 방법과 같이 설정되어 있을 경우 취약하다고 볼 수 있으며, 한 가
지 경우라도 설정이 되어 있지 않거나 해당 설정이 없을 시 양호하다고 판단함
1. asa / asax 스크립트 매핑 확인
Step 1) 매핑이 없을 경우 양호
인터넷 정보 서비스(IIS) 관리자> 해당 웹 사이트> IIS> "처리기 매핑" 선택, 사용
항목에 *.asa / *.asax 등록되지 않을 경우 양호
※ 아래 이미지처럼 등록되어 있을 경우 삭제 시 양호
2. asa / asax 파일 필터링 확인
Step 1) false 일 경우 양호
인터넷 정보 서비스(IIS) 관리자> 해당 웹 사이트> IIS> “요청 필터링” 선택, .asa /
.asax 확장자가 false로 설정되어 있는지 확인
※ true 일 경우 제거하고 "파일 이름 확장명 거부" 에 등록
---
W-19 (상) 2. 서비스 관리 > 2.13 IIS 가상 디렉토리 삭제
취약점 개요
점검내용  불필요한 IIS 가상 디렉토리 삭제 여부 점검
점검목적
 IIS 를 설치 시 가상 디렉토리 내에 제공되는 취약한 샘플 어플리케이션을
제거하여 잠재적인 위험을 제거하기 위함
보안위협
 기본 가상 디렉토리가 삭제되지 않은 경우 ADSI 스크립트를 이용한 기본 웹
사이트 설정을 변경 및 MSADC 가상 디렉토리를 통한 서버 자원 접근이 가
능하여 악의적인 공격의 대상이 될 수 있음
참고
※ /issadmpwd 파일을 제거하고 이 외 존재하는 가상 디렉토리 취약점을 줄이기 위해서
IIS Admin에 관계되는 모든 파일 및 디렉토리를 삭제하여야 함
※ IIS 4.0, 5.0 설치 시 기본적으로 /issadmpwd라는 가상 디렉토리를 생성하는데, 이 디
렉토리에는 웹 서버를 통하여 패스워드를 변경시켜주는 기능 등을 하는 .HTR 파일이
존재함
점검대상 및 판단기준
대상  Windows NT, 2000
판단기준
양호 : 해당 웹 사이트에 IIS Admin, IIS Adminpwd 가상 디렉토리가 존재하지 않는
경우
취약 : 해당 웹 사이트에 IIS Admin, IIS Adminpwd 가상 디렉토리가 존재하는 경우
※ 조치 시 마스터 속성과 모든 사이트에 적용함
조치방법 사용하지 않는 경우 IIS 서비스 중지, 사용할 경우 IIS Admin, IIS Adminpwd 삭제
점검 및 조치 사례
■ Windows 2000(IIS 5.0)
Step 1) 시작> 실행> INETMGR> 웹 사이트> IISAdmin, IISAdminpwd 선택> 삭제
※ Windows 2003(6.0) 이상 버전 해당 사항 없음
조치 시 일반적으로 IIS 관리용 페이지를 사용하지 않으므로 영향 없음
---
W-20 (상) 2. 서비스 관리 > 2.14 IIS 데이터 파일 ACL 적용
취약점 개요
점검내용  IIS 데이터 파일 ACL 적용 여부 점검
점검목적
 웹 데이터 파일에 ACL을 부여함으로써 권한 없는 사용자로부터의 실행 및
읽기를 방지하고자 함
보안위협
 웹 데이터 파일에 ACL을 부여되지 않은 경우 권한 없는 사용자로부터의 읽
기 및 실행이 가능
참고
※ 향후 필요에 의해 IIS를 설치하여 운용한다면 웹 데이터 파일에 대한 ACL을 부여하는
것이 바람직하며 ACL을 설정할 때에는 다음과 같은 사항을 참고하여 설정하여야 함
1. 가능한 파일의 종류끼리 분류하여 폴더에 저장
2. 홈 디렉토리(기본: c:\inetpub\wwwroot)내에 적절한 ACL 권한 부여.
※ ACL(Access Control List): 접근이 허가된 주체들과 허가받은 접근 종류들이 기록된 목록
점검대상 및 판단기준
대상  Windows 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : 홈 디렉토리 내에 있는 하위 파일들에 대해 Everyone 권한이 존재하지
않는 경우(정적 콘텐츠 파일은 Read 권한만)
취약 : 홈 디렉토리 내에 있는 하위 파일들에 대해 Everyone 권한이 존재하는
경우(정적 콘텐츠 파일은 Read 권한 제외)
※ 조치 시 마스터 속성과 모든 사이트에 적용함
조치방법
IIS 서비스를 사용하지 않는 경우 IIS 서비스 중지, 사용할 경우 홈 디렉토리에
Administrators, System 권한만 설정 후, 하위 디렉토리에 존재하는 모든
Everyone 권한 제거(정적 콘텐츠 파일에 경우 Read 권한 허용)
점검 및 조치 사례
■ Windows 2000(IIS 5.0), 2003(IIS 6.0)
Step 1) 시작> 실행> INETMGR> 웹 사이트> 해당 웹사이트> 속성> 홈 디렉토리 경로 확인
Step 2) 탐색기를 이용하여 홈 디렉토리의 등록정보> [보안] 탭에서 Everyone 권한 확인
Step 3) 아래와 같은 파일들에 대한 불필요한 Everyone 권한 제거
파일 형식 액세스 제어 목록
CGI (.exe, .dll, .cmd, .pl) 모든 사람(X), 관리자/시스템(전체 제어)
스크립트 파일(.asp) 모든 사람(X), 관리자/시스템(전체 제어)
포함 파일(.inc, .shtm, .shtml) 모든 사람(X), 관리자/시스템(전체 제어)
정적 콘텐츠(.txt, .gif, .jpg, .html) 모든 사람(R), 관리자/시스템(전체 제어)
---
W-20 (상) 2. 서비스 관리 > 2.14 IIS 데이터 파일 ACL 적용
■ Windows 2008(IIS 7.0), 2012(IIS 8.0), 2016(IIS 10.0), 2019(IIS 10.0)
Step 1) 시작> 실행> INETMGR> 사이트> 해당 웹사이트> 기본 설정> 홈 디렉토리 실제 경
로 확인
Step 2) 탐색기를 이용하여 홈 디렉토리의 등록 정보> [보안] 탭에서 Everyone권한 확인
Step 3) 아래와 같은 파일들에 대한 불필요한 Everyone 권한 제거

파일 형식 액세스 제어 목록
CGI (.exe, .dll, .cmd, .pl) 모든 사람(X), 관리자/시스템(전체 제어)
스크립트 파일(.asp) 모든 사람(X), 관리자/시스템(전체 제어)
[웹사이트 실제 경로 확인]
[웹사이트 홈디렉토리 내 everyone 권한 확인]
조치 시
영향
IIS에서 홈 디렉토리 내에 있는 데이터 파일 권한 조치에 따른 검증 필요
---
W-21 (상) 2. 서비스 관리 > 2.15 IIS 미사용 스크립트 매핑 제거
취약점 개요
점검내용  IIS 미사용 스크립트 매핑 제거 여부 점검
점검목적  사용하지 않은 확장자 매핑을 제거하여 추가 공격의 위험을 제거하기 위함
보안위협
 미사용 확장자 매핑을 제거하지 않은 .htr .idc .stm .shtm .shtml .printer .htw
.ida .idq 확장자는 버퍼 오버플로우(Buffer Overflow) 공격 위험이 존재함
참고
※ 사용하지 않는 스크립트 매핑은 보안에 위협이 될 수 있으므로 개발자와 협의하여 불
필요한 매핑인지 확인한 후 제거해야 함
※ .asp나 .shtm 과 같은 확장자들은 특정 DLL 파일과 매핑 되어 있어, 이러한 파일들에
대한 요청이 들어오면 해당 DLL에 의해 처리됨
※ 스크립트 매핑: IIS는 클라이언트가 요청한 자원의 파일 확장자에 따라서 이를 처리할
ISAPI 확장 핸들러를 지정하게 되어 있는데 이를 스크립트 매핑이라고 함
※ 버퍼 오버플로우(Buffer Overflow): 메모리에 할당된 버퍼의 양을 초과하는 데이터를 입
력하여 프로그램의 복귀 주소를 조작, 궁극적으로 해커가 원하는 코드를 실행하는 것
점검대상 및 판단기준
대상  Windows 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : 취약한 매핑(.htr .idc .stm .shtm .shtml .printer .htw .ida .idq)이 존재하
지 않는 경우
취약 : 취약한 매핑(.htr .idc .stm .shtm .shtml .printer .htw .ida .idq)이 존재하
는 경우
※ 조치 시 마스터 속성과 모든 사이트에 적용함
조치방법
사용하지 않는 경우 IIS 서비스 중지, 사용할 경우 취약한 매핑 제거 (아래 표
참고)
점검 및 조치 사례
확장자명 기능 취약점
asp Active Server Pages 기능 지원
Buffer Overflow MS02-018
• Win 2000 SP3 이상 양호
htr
Web-based password reset:
Outlook Web Access 등에서 웹 기반 응용
프로그램으로 자신의 사용자 계정 암호 변경
+.htr 소스 공개 취약점 MS01-004
• Win 2000 SP3, NT SP 7.0 이상 양호
■ Windows 2000(IIS 5.0), 2003(IIS 6.0)
Step 1) 시작> 실행> INETMGR> 웹 사이트> 해당 웹 사이트> 속성> [홈 디렉토리] 탭에서
[구성] 버튼 선택
Step 2) [매핑] 탭에서 아래와 같은 취약한 매핑 제거

idc
Internet Database Connector:
SQL 서버에 연결하기 위한 정보 등을
관리함. asp를 통해 같은 작업을 수행 가능
Web 디렉토리 패스 공개 Q193689
• NT4.0, NT SP6a이상 양호
stm, stml,
shtml
Server-Side Includes
Buffer Overflow MS01-044
• Win 2000 SP3 이상 양호
printer
Internet Printing : URL을 사용하여
페이지를 프린터로 인쇄할 수 있도록 함
IIS가 인터넷이나 인트라넷을 통해 인쇄
서버 기능 수행
Buffer Overflow MS01-023
• Win 2000 SP2 이상 양호
ida, idq
Index Server : idq.dll에 매핑되며 인덱스
서버를 쿼리할 때 사용
Buffer Overflow MS01-033
• Win 2000 SP3 이상 양호
htw
Index Server : webhits.dll에 매핑되며,
인덱스 서버를 쿼리할 때 사용
Webhit 소스 공개 취약점 MS00-006
• Win 2000 SP1 이상 양호
■ Windows 2008(IIS 7.0), 2012(IIS 8.0), 2016(IIS 10.0), 2019(IIS 10.0)
Step 1) 시작> 실행> INETMGR> 웹 사이트> 해당 웹 사이트> 처리기 매핑 선택
Step 2) 취약한 매핑 제거(.htr, .idc, .stm, .shtm, .shtml, .printer, .htw, .ida, .idq)
---
W-22 (상) 2. 서비스 관리 > 2.16 IIS Exec 명령어 쉘 호출 진단
취약점 개요
점검내용  IIS Exec 명령어 쉘 호출 여부 진단
점검목적
 웹 서버에서 임의 명령어 호출을 제한하여 허가되지 않은 명령어 실행을 차
단하기 위함
보안위협
 웹 서버에서 # exec 명령어를 통한 명령어 실행이 차단되지 않은 경우, 웹
서버에서 임의의 시스템 명령이 호출 가능하여 허가되지 않은 파일의 실행
위험 존재
참고 -
점검대상 및 판단기준
대상  Windows NT, 2000
판단기준
양호 : IIS 5.0 버전에서 해당 레지스트리 값이 0이거나, IIS 6.0 버전 이상인 경우
취약 : IIS 5.0 버전에서 해당 레지스트리 값이 1인 경우
조치방법 위의 양호 기준에 맞춰 레지스트리 값 설정
점검 및 조치 사례
■ Windows NT(IIS 4.0), 2000(IIS 5.0)
Step 1) 시작> 실행> REGEDIT> HKLM\SYSTEM\CurrentControlSet\Services\W3SVC
\Parameters 검색
Step 2) DWORD> SSIEnableCmdDirective 값을 찾아 값을 “0”으로 입력
※ IIS 6.0 이상 버전(windows 2003 이상) 해당 사항 없음
조치 시
영향
일반적인 경우 영향 없음
---
W-23 (상) 2. 서비스 관리 > 2.17 IIS WebDAV 비활성화
취약점 개요
점검내용  IIS WebDAV 비활성화 여부 점검
점검목적
 WebDAV 서비스를 비활성화 하여, IIS WebDAV에서 발견되는 다수의 인증
우회 취약점을 제거하고자 함
보안위협
 WebDAV가 활성화 되어 있는 경우 IIS에 악의적으로 작성된 HTTP 요청을
이용하여 인증을 우회함으로써 패스워드로 보호된 WebDAV의 자원에 접근
(디렉토리 열람, 파일 다운로드 등)이 가능
 WebDAV에 의해 호출된 일부 구성 요소에 매개 변수를 정확하게 점검하지
않는 결함이 존재하여, 이로 인해 버퍼 오버런이 발생 가능
참고
※ WebDAV(Web Distributed Authoring and Versioning): 사용자가 원격 World Wide
Web 서버를 이용하여 파일을 수정하거나 처리할 수 있도록 하는 HTTP의 확장 서비
스. 웹상의 공동개발을 지원하기 위한 IETF 표준안(RFC 2518)으로써, 원격지 사용자들
간에 인터넷상에서 파일을 공동 편집하고 관리할 수 있도록 함
점검대상 및 판단기준
대상  Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : 다음 중 한 가지라도 해당하는 경우
1. IIS 서비스를 사용하지 않는 경우
2. DisableWebDAV 값이 1로 설정되어 있는 경우
3. Windows NT, 2000은 서비스팩 4 이상이 설치되어 있는 경우
4. Windows 2003 이상은 WebDAV가 금지 되어 있는 경우
취약 : 양호 기준에 한 가지라도 해당하지 않는 경우(2003, 2008은 1,4번만)
조치방법
IIS 서비스를 사용하지 않는 경우 IIS 서비스 중지, 사용할 경우 해당 레지스트
리 값을 1로 설정함
(Windows NT, 2000 서비스팩 4 이상 양호, Windows 2003 이상 WebDAV금지
시 양호)
점검 및 조치 사례
■ Windows NT, 2000
Step 1) 시작> 실행> SERVICES.MSC> World Wide Web Publishing Service> 속성
Step 2) 시작 유형 -> 사용 안 함 / 서비스 상태 -> 중지
< IIS를 사용하지만 WebDAV를 사용하지 않는 경우 >
1. 시작> 실행> REGEDIT 실행
2. HKLM\SYSTEM\CurrentControlSet\Services\W3SVC\Parameters
3. 마우스 우클릭> 새로 만들기 DWORD 값을 선택
4. DisableWebDAV 입력 (Default 값인 “0”을 “1”로 변경)
<IIS를 사용하고, WebDAV도 필요한 경우 >
1. Windows NT 인 경우 windows update 실행
2. Windows 2000 서비스팩 버전이 2, 3인 경우 windows update 실행
3. Windows 2000 서비스팩 버전이 4인 경우 - 취약점 없음
※ 시스템 재시작 후 적용됨
■ Windows 2003
Step 1) 시작> 실행> INETMGR> 웹 사이트> 웹 서비스 확장
Step 2) WebDAV 금지
■ Windows 2008, 2012, 2016, 2019
Step 1) 인터넷 정보 서비스(IIS) 관리자> 서버 선택> IIS> "ISAPI 및 CGI 제한" 선택,
WebDAV 사용여부 확인 (허용됨일 경우 취약)
Step 2) 인터넷 정보 서비스(IIS) 관리자> 서버 선택> IIS> "ISAPI 및 CGI 제한" 선택 WebDAV
항목 선택> [작업]에서 제거하거나, 편집> "확장 경로 실행 허용(A)" 체크 해제
---
W-24 (상) 2. 서비스 관리 > 2.18 NetBIOS 바인딩 서비스 구동 점검
취약점 개요
점검내용  NetBIOS 바인딩 서비스 구동 여부 점검
점검목적
 NetBIOS와 TCP/IP 바인딩을 제거하여 TCP/IP를 거치게 되는 파일 공유서비
스를 제공하지 못하도록 하고, 인터넷에서의 공유자원에 대한 접근 시도를
방지하고자 함
보안위협
 인터넷에 직접 연결되어 있는 윈도우 시스템에서 NetBIOS TCP/IP 바인딩이
활성화 되어 있을 경우 공격자가 네트워크 공유자원을 사용할 우려 존재
참고
※ NetBIOS(Network Basic Input/Output System)는 별개의 컴퓨터상에 있는 애플리케이
션들이 근거리통신망 내에서 서로 통신 할 수 있게 해주는 프로그램. IBM pc를 위한
네트워크 인터페이스 체계로 네임, 세션, 데이터그램의 세가지 서비스를 제공하며
NetBIOS를 통해 파일 공유와 프린터 공유 등을 서비스로 이용
점검대상 및 판단기준
대상  Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : TCP/IP와 NetBIOS 간의 바인딩이 제거 되어 있는 경우
취약 : TCP/IP와 NetBIOS 간의 바인딩이 제거 되어있지 않은 경우
조치방법 네트워크 제어판을 이용하여 TCP/IP와 NetBIOS 간의 바인딩(binding) 제거
점검 및 조치 사례
■ Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
Step 1) 시작> 실행> ncpa.cpl> 로컬 영역 연결> 속성> TCP/IP> [일반] 탭에서 [고급] 클릭> [WINS]
탭에서 TCP/IP에서 “NetBIOS 사용 안 함” 또는, “NetBIOS over TCP/IP 사용 안 함” 선택
조치 시
영향
TCP/IP을 거치게 되는 파일 공유 서비스가 제공되지 않음
인터넷에서의 공유 자원에 대한 접근시도가 불가능함
(라우터를 거치지 않은 내부 네트워크에서는 가능함)
---
W-25 (상) 2. 서비스 관리 > 2.19 FTP 서비스 구동 점검
취약점 개요
점검내용  시스템 내 FTP 서비스 구동 여부 점검
점검목적
 인증 정보가 기본적으로 평문전송 되는 취약한 프로토콜인 FTP의 사용을 제
한하여 네트워크 보안성을 높이고자 함
보안위협
 OS에서 제공하는 기본적인 FTP 서비스를 사용할 경우 계정과 패스워드가 암
호화되지 않은 채로 전송 되어 Sniffer에 의한 계정 정보의 노출 위험 존재
참고 ※ Sniffer: 네트워크 트래픽을 감시하고 분석하는 프로그램
점검대상 및 판단기준
대상  Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : FTP 서비스를 사용하지 않는 경우 또는 secure FTP 서비스를 사용하는 경우
취약 : FTP 서비스를 사용하는 경우
조치방법 FTP 서비스가 필요하지 않다면 서비스 중지 또는 secure FTP 응용프로그램 사용
점검 및 조치 사례
■ Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
Step 1) 시작> 실행> SERVICES.MSC> FTP Publishing Service(Windows 2012 이상 :
Microsoft FTP Service)> 속성> [일반] 탭에서 "시작 유형"을 “사용 안 함”으로 설정한
후, FTP 서비스 중지
조치 시
영향
일반적인 경우 영향 없음
---
W-26 (상) 2. 서비스 관리 > 2.20 FTP 디렉토리 접근권한 설정
취약점 개요
점검내용  FTP 홈디렉토리의 접근 권한 적절성 점검
점검목적
 FTP 서비스 디렉토리의 접근 권한을 적절하게 설정하여 의도치 않은 정보유
출 등의 보안 사고를 방지하고자 함
보안위협
 FTP 홈디렉토리에 과도한 권한(예. Everyone Full Control)이 부여된 경우 임의
의 사용자가 쓰기, 수정이 가능하여 정보유출, 파일 위‧변조 등의 위험 존재
참고
※ 기반시설 시스템은 FTP 서비스를 사용하지 않는 것이 원칙이나, 조직 내에서 해당 서
비스를 부득이 사용해야 하는 경우 관련 보호 대책을 수립 및 적용하여 활용하여야 함
※ 관련 점검 항목 : W-27(상), W-28(상)
점검대상 및 판단기준
대상  Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : FTP 홈 디렉토리에 Everyone 권한이 없는 경우
취약 : FTP 홈 디렉토리에 Everyone 권한이 있는 경우
조치방법 FTP 홈 디렉토리에서 Everyone 권한 삭제, 각 사용자에게 적절한 권한 부여
점검 및 조치 사례
■ Windows NT(IIS 4.0), 2000(IIS 5.0), 2003(IIS 6.0)
Step 1) 인터넷 정보 서비스(IIS) 관리> FTP 사이트> 해당 FTP 사이트> 속성> [홈 디렉토리]
탭에서 FTP 홈 디렉토리 확인
Step 2) 탐색기> 홈 디렉토리> 속성> [보안]탭에서 Everyone 권한 제거
■ Windows 2008(IIS 7.0), 2012(IIS 8.0), 2016(IIS 10.0), 2019(IIS 10.0)
Step 1) 제어판> 관리도구> 인터넷 정보 서비스(IIS) 관리> 사이트 > 해당 FTP 사이트> FTP
권한 부여 규칙 선택
Step 2) 허용 권한 부여 규칙에서 [지정한 사용자] 지정
---
W-27 (상) 2. 서비스 관리 > 2.21 Anonymous FTP 금지
취약점 개요
점검내용  FTP 서비스의 Anonymous(익명) 접속 허용 여부 점검
점검목적  FTP 익명 접속을 제한하여, 중요 정보의 불법 유출을 차단 하고자 함
보안위협
 FTP 익명 접속이 허용된 경우 핵심 기밀 자료나 내부 정보의 불법 유출 가능
성이 존재함
참고
※ 만약 익명 접속이 허용된 FTP 서버에 익명 사용자에 대해 쓰기 권한이 부여된 경우,
정상적으로 업로드한 파일들의 변조가 가능하므로 공개한 디렉토리 내 중요 데이터가
보관되어 있는지 여부를 추가적으로 확인하여야 함
점검대상 및 판단기준
대상  Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : FTP 서비스를 사용하지 않거나, “익명 연결 허용”이 체크되지 않은 경우
취약 : FTP 서비스를 사용하거나, “익명 연결 허용”이 체크되어 있는 경우
조치방법
FTP 서비스를 사용하지 않는 경우 서비스 중지, 사용할 경우 “익명 연결 허용”
체크 해제 또는 "익명" 체크 해제
점검 및 조치 사례
■ Windows NT(IIS 4.0), 2000(IIS 5.0), 2003(IIS 6.0)
Step 1) 인터넷 정보 서비스(IIS) 관리> FTP 사이트> 속성> [보안 계정] 탭에서 “익명 연결
허용” 체크박스 해제 (만약 개별 FTP 사이트에 적용할 경우 해당 사이트에만 설정이
적용되고, 기본 설정은 적용 받지 않음)
■ Windows 2008(IIS 7.0), 2012(IIS 8.0), 2016(IIS 10.0), 2019(IIS 10.0)
Step 1) 제어판> 관리도구> 인터넷 정보 서비스(IIS) 관리> 해당 FTP 사이트> FTP 인증 선택
Step 2) FTP 인증 화면에서 익명 인증 사용 안함 설정
조치 시
영향
애플리케이션에서 익명 연결을 사용할 경우를 제외하고, 일반적으로 영향 없음
---
W-28 (상) 2. 서비스 관리 > 2.22 FTP 접근 제어 설정
취약점 개요
점검내용  FTP 접속 가능한 IP 주소 지정 여부 점검
점검목적
 FTP 접근 시 특정 IP 주소에 대해 콘텐츠 액세스를 허용하여 서비스 보안성
을 강화하고자 함
보안위협
 FTP 프로토콜은 로그온에 지정된 자격 증명이나 데이터 자체가 암호화 되지
않고 모든 자격 증명을 일반 텍스트로 네트워크를 통해 전송되는 특성상 서
버 클라이언트간 트래픽 스니핑을 통해 인증정보가 쉽게 노출되므로 접속
허용된 사용자 IP를 지정하여 접속자를 제한할 것을 권고
참고
※ 기반시설 시스템은 FTP 서비스를 사용하지 않는 것이 원칙이나, 조직 내에서 해당 서
비스를 부득이 사용해야 하는 경우 관련 보호 대책을 수립 및 적용하여 활용하여야 함
※ 관련 점검 항목 : W-26(상), W-27(상)
점검대상 및 판단기준
대상  Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : 특정 IP 주소에서만 FTP 서버에 접속하도록 접근제어 설정을 적용한 경우
취약 : 특정 IP 주소에서만 FTP 서버에 접속하도록 접근제어 설정을 적용하지 않
은 경우
※ 조치 시 마스터 속성과 모든 사이트에 적용함
조치방법 특정 IP 주소에서만 FTP 서버에 접속하도록 접근제어 설정
점검 및 조치 사례
■ Windows NT(IIS 4.0), 2000(IIS 5.0), 2003(IIS 6.0)
Step 1) 인터넷 정보 서비스(IIS) 관리> FTP 사이트> 속성> [디렉토리 보안] 탭에서 “액세스
거부” 선택 후 접근 가능 IP 주소 추가 (만약 개별 FTP 사이트에 적용할 경우 해당
사이트에만 설정이 적용되고, 기본 설정은 적용 받지 않음)
[참고] 액세스 허가: 모든 액세스를 허용 후 액세스를 거부할 컴퓨터, 그룹, 도메인 추가
액세스 거부: 모든 액세스를 거부 후 액세스를 허용할 컴퓨터, 그룹, 도메인 추가
■ Windows 2008(IIS 7.0), 2012(IIS 8.0), 2016(IIS 10.0), 2019(IIS 10.0)
Step 1) 제어판> 관리도구> 인터넷 정보 서비스(IIS) 관리> 해당 FTP 사이트> FTP IPv4 주소
및 도메인 제한
Step 2) [작업]의 허용 항목 추가에서 FTP 접속을 허용할 IP 입력
Step 3) [작업] 의 기능 설정 편집에서 지정되지 않은 클라이언트에 대한 액세스를 거부 선택
---
W-29 (상) 2. 서비스 관리 > 2.23 DNS Zone Transfer 설정
취약점 개요
점검내용  DNS Zone Transfer 차단 설정 여부 점검
점검목적
 DNS Zone Transfer 차단 설정을 적용하여 도메인 정보의 불법 외부 유출을
막고자 함
보안위협
 DNS Zone Transfer 차단 설정이 적용되지 않은 경우 DNS 서버에 저장되어
있는 도메인 정보를 승인된 DNS 서버가 아닌 외부로 유출 위험 존재
참고
※ zone-transfer: zone(영역) 전송이라고 하며 master와 slave간에 또는 primary와
secondary DNS간에 zone 파일을 동기화하기 위한 용도로 사용되는 기술
점검대상 및 판단기준
대상  Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : 아래 기준에 해당될 경우
1. DNS 서비스를 사용 않는 경우
2. 영역 전송 허용을 하지 않는 경우
3. 특정 서버로만 설정이 되어 있는 경우
취약 : 위 3개 기준 중 하나라도 해당 되지 않는 경우
조치방법
불필요 시 서비스 중지/사용 안 함, 사용하는 경우 영역 전송을 특정 서버로 제
한하거나 “영역 전송 허용”에 체크 해제
점검 및 조치 사례
■ Windows NT
Step 1) 시작> 프로그램> 관리 도구> DNS 관리자> 각 조회 영역> 해당 영역> 등록 정보>
알림
Step 2) “알림 목록에 있는 보조 영역에서만 액세스 허용” 선택 후 서버 IP 추가
■ Windows 2000, 2003, 2008, 2012, 2016, 2019
Step 1) 시작> 실행> DNSMGMT.MSC> 각 조회 영역> 해당 영역> 속성> 영역 전송
Step 2) “다음 서버로만” 선택 후 전송할 서버 IP 추가
Step 3) 불필요 시 해당 서비스 제거
시작> 실행> SERVICES.MSC> DNS 서버> 속성 [일반] 탭에서 "시작 유형"을 "사용
안 함"으로 설정한 후, DNS 서비스 중지
조치 시
영향
영역 전송할 경우 서버를 지정해 주면 영향 없음
---
W-30 (상) 2. 서비스 관리 > 2.24 RDS(Remote Data Services)제거
취약점 개요
점검내용  RDS(Remote Data Services) 비활성화 여부 점검
점검목적  취약한 RDS 서비스를 제거하여 불법적인 원격 공격을 차단하기 위함
보안위협
 취약한 플랫폼의 RDS가 사용되는 경우 서비스 거부 공격이나 원격에서 관
리자 권한으로 임의의 명령을 실행할 수 있는 위험이 존재함
참고
※ MDAC 2.7 미만의 버전에서 웹 서버와 웹 클라이언트는 모두 이 취약점으로 인해 위
험해질 수 있으므로 RDS가 불필요할 경우 제거하는 것이 안전함
※ RDS(Remote Data Services): MDAC(Microsoft Data Access Components)의 한 컴포넌
트로 클라이언트에 있는 데이터를 다룰 수 있도록 하는 서비스
점검대상 및 판단기준
대상  Windows NT, 2000, 2003
판단기준
양호 : 다음 중 한 가지라도 해당되는 경우(2008 이상 양호)
1. IIS를 사용하지 않는 경우
2. Windows 2000 서비스팩 4, Windows 2003 서비스팩 2 이상 설치되
어 있는 경우
3. 디폴트 웹 사이트에 MSADC 가상 디렉토리가 존재하지 않는 경우
4. 해당 레지스트리 값이 존재하지 않는 경우
취약 : 양호 기준에 한 가지도 해당되지 않는 경우
조치방법
사용하지 않는 경우 IIS 서비스 중지/사용 안 함, 사용할 경우 레지스트리 키 값
제거 또는 관련 패치 적용
점검 및 조치 사례
■ Windows NT, 2000, 2003 < RDS 제거 방법 >
Step 1) 웹 사이트로부터 “/msadc” 가상 디렉토리 제거
시작> 실행> INETMGR> 웹 사이트 선택 후 오른쪽 디렉토리에서 msadc 제거
Step 2) 다음의 레지스트리 키/디렉토리 제거
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W3SVC\Parameters\
ADCLaunch\RDSServer.DataFactory
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W3SVC\Parameters\
ADCLaunch\AdvancedDataFactory
HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\W3SVC\Parameters\
ADCLaunch\VbBusObj.VbBusObjCls
조치 시
영향
WAS와 연동될 경우 일부 RDS를 사용하는 경우가 있으며 사용할 경우 레지스
트리 키 값 제거
---
W-31 (상) 2. 서비스 관리 > 2.25 최신 서비스팩 적용
취약점 개요
점검내용  최신 서비스팩 적용 여부 점검
점검목적
 시스템을 최신 버전으로 유지하여 새로운 위협 및 진행 중인 위협으로부터
중요 정보와 시스템을 보호하기 위함
보안위협
 보안 업데이트를 적용하지 않은 경우 시스템 및 응용프로그램의 취약성으로
인해 권한 상승, 원격 코드 실행, 보안 기능 우회 등의 문제를 일으킬 수 있음
참고
※ 서비스팩: Windows의 안정성을 높이기 위해 응용프로그램, 서비스, 실행 파일 등 여러
수정 파일들을 모아 놓은 업데이트 프로그램
점검대상 및 판단기준
대상  Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : 최신 서비스팩이 설치되어 있으며 적용 절차 및 방법이 수립된 경우
취약 : 최신 서비스팩이 설치되지 않거나, 적용 절차 및 방법이 수립되지 않은 경우
조치방법 설치에 따른 영향도 확인 후 최신 서비스팩 설치(설치 후 시스템 재시작 필요)
점검 및 조치 사례
■ Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
Step 1) 시작> 실행> Winver
Step 2) 서비스팩 버전 확인 후 최신 버전이 아닌 경우 아래 사이트에서 최신 서비스팩
다운로드 후 설치 또는 자동업데이트 활용
※ 인터넷 웜(Worm)이 Windows의 취약점을 이용하여 공격하기 때문에 서비스팩 설치
시에는 네트워크와 분리된 상태에서 설치 할 것을 권장
[최신 서비스팩 정보(2020년 8월 기준)]
운영체제 종류 최신 서비스팩 서비스 제공 여부
Windows NT Service pack 6a 중단
Windows Server 2000 Service pack 4 중단
Windows Server 2003 Service pack 2 중단
Windows Server 2008
2008: Service pack 2
R2: Service pack 1
중단
Windows Server 2012
2012: 없음
R2: 없음
제공
Windows Server 2016 2016 : 없음 제공
Windows Server 2019 2019 : 없음 제공
※ Windows Server 2008이하 버전의 경우 현재(2020년 8월 기준) 공식적인 서비스
제공이 중단되어 조직에서 2008 이하 버전의 시스템을 사용하는 것은 적절하지 않음
[제품별 수명주기 사이트(2020년 8월 기준)]
Microsoft Windows Server 제품별 지원
https://support.microsoft.com/ko-kr/lifecycle/search
---
W-58 (중) 2. 서비스 관리 > 2.26 터미널 서비스 암호화 수준 설정
취약점 개요
점검내용  터미널 서비스 암호화 수준 적절성 점검
점검목적
 터미널 서비스 암호화 설정으로 데이터를 암호화하여 클라이언트와 서버간
의 통신에서 전송되는 데이터를 보호하기 위함
보안위협
 서버 접속 시에 낮은 암호화 수준을 적용할 경우 악의적인 사용자에 의해
서버와 클라이언트간 주고받는 정보가 노출될 우려가 있음
참고
※ 기반시설 시스템은 터미널 서비스의 사용을 원칙적으로 금지하나, 부득이 해당 서비스를
사용해야 하는 경우 클라이언트 서버간의 데이터 전송 시 암호화하여 보호해야 함
점검대상 및 판단기준
대상  Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : 터미널 서비스를 사용하지 않거나 사용 시 암호화 수준을 “클라이언트와
호환 가능(중간)” 이상으로 설정한 경우
취약 : 터미널 서비스를 사용하고 암호화 수준이 “낮음” 으로 설정한 경우
조치방법
터미널 서비스의 가동을 ‘중지’ 및 ‘사용 안 함’ 설정을 하거나, 부득이 사용할
경우 암호화 수준 설정 적용
점검 및 조치 사례
■ Windows NT
Step 1) 시작> 실행> regedit
Step 2) HKLM\SYSTEM\CurrentControlSet\Control\Terminal Server\WinStations\RDP-Tcp
\MinEncryptionLevel 값을 2(중간) 이상으로 설정
■ Windows 2000
Step 1) 시작> 실행> TSCC.MSC> “해당 서비스” 선택> 속성
Step 2) 암호화 수준 → 중간(Windows 2000) 이상으로 설정
암호화 수준 설 명
낮음
클라이언트에서 서버로 보낸 데이터만 서버의 표준 키 길이를 기반으로 하는 암호
화로 보호. 서버가 클라이언트로 보낸 데이터는 보호되지 않음
중간
클라이언트와 서버 간에 받은 모든 데이터는 서버의 표준 키 길이를 기반으로 암호
화로 보호
높음
클라이언트와 서버 간에 받은 모든 데이터는 서버의 최대 키 길이를 기반으로 암호
화로 보호

■ Windows 2003
Step 1) Windows 2003: 시작> 실행> TSCC.MSC> “해당 서비스” 선택> 속성
Step 2) [일반] 탭에서 암호화 수준 설정 → 클라이언트 호환 가능

암호화 수준 설 명
낮음
클라이언트에서 서버로 보내는 모든 데이터는 클라이언트가 지
원하는 최대 키 강도를 기반으로 하는 암호화로 보호
클라이언트 호환 가능
클라이언트와 서버 간에 받은 모든 데이터는 클라이언트가 지원
하는 최대 키 강도를 기반으로 하는 암호화로 보호
높음
클라이언트와 서버 간에 받은 모든 데이터는 서버의 최대 키 강
도를 기반으로 하는 암호화로 보호하며 이 암호화 수준을 지원
하지 않는 클라이언트는 연결할 수 없음
FIPS 규격
클라이언트에서 서버로 보내는 모든 데이터를 Federal Information
Processing Standard 140-1 유효 암호화 방법을 사용하여 보호
■ Windows 2008, 2012, 2016, 2019
Step 1) 시작> 실행> GPEDIT.MSC(로컬 그룹 정책 편집기)
Step 2) 컴퓨터 구성> 관리 템플릿> Windows 구성 요소> 터미널 서비스> 원격 데스크톱
세션 호스트> 보안
Step 3) [클라이언트 연결 암호화 수준 설정]> [암호화 수준]을 클라이언트 호환 가능으로
설정
암호화 수준 설 명
낮은 수준
클라이언트에서 서버로 전송되는 데이터만 56비트 암호화를 사
용하여 암호화함
클라이언트 호환 가능
클라이언트와 서버 간에 전송되는 데이터를 클라이언트가 지원
하는 최대 키 강도로 암호화하며 128비트 암호화를 지원하지 않
는 클라이언트가 있는 환경에서 이 암호화 수준을 사용해야 함
높은 수준
강력한 128비트 암호화 방식을 사용하여 클라이언트에서 서버로
그리고 서버에서 클라이언트로 전송되는 데이터를 암호화하며
128비트 클라이언트(예: 원격 데스크톱 연결을 실행하는 클라이
언트)만 있는 환경에서 이 암호화 수준을 사용해야 함
이 암호화 수준을 지원하지 않는 클라이언트는 RD 세션 호스트
서버에 연결할 수 없음
암호화 수준 설 명
낮은 수준
클라이언트에서 서버로 전송되는 데이터만 56비트 암호화를 사
용하여 암호화함
클라이언트 호환 가능
클라이언트와 서버 간에 전송되는 데이터를 클라이언트가 지원
하는 최대 키 강도로 암호화하며 128비트 암호화를 지원하지 않
는 클라이언트가 있는 환경에서 이 암호화 수준을 사용해야 함
높은 수준
강력한 128비트 암호화 방식을 사용하여 클라이언트에서 서버로
그리고 서버에서 클라이언트로 전송되는 데이터를 암호화하며
128비트 클라이언트(예: 원격 데스크톱 연결을 실행하는 클라이
언트)만 있는 환경에서 이 암호화 수준을 사용해야 함
이 암호화 수준을 지원하지 않는 클라이언트는 RD 세션 호스트
서버에 연결할 수 없음
---
W-59 (중) 2. 서비스 관리 > 2.27 IIS 웹서비스 정보 숨김
취약점 개요
점검내용  IIS 웹서비스 정보 숨김 설정 여부 점검
점검목적
 IIS 웹서비스 운용 시 에러 페이지, 웹 서버 종류, 사용 OS, 사용자 계정이름
등 웹 서버와 관련된 불필요한 정보가 노출되지 않도록 하기 위함
보안위협
 IIS 웹서비스 정보 숨김 설정이 적용되지 않은 경우 악의적인 사용자에게 불
필요한 정보가 노출되어 외부 공격을 위한 기초 자료로 이용될 수 있음
참고 -
점검대상 및 판단기준
대상  Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : 웹 서비스 에러 페이지가 별도로 지정되어 있는 경우
취약 : 웹 서비스 에러 페이지가 별도로 지정되지 않아 에러 발생 시 중요 정보
가 노출되는 경우
조치방법 발생 가능한 각 에러에 대한 별도의 웹 서비스 에러 페이지를 지정함
점검 및 조치 사례
■ Windows NT, 2000, 2003
Step 1) 인터넷 정보 서비스(IIS) 관리> 속성> [사용자 지정 오류] 탭에서 400, 401, 403, 404,
500 등 웹 서비스 에러에 대해 별도의 페이지를 지정
■ Windows 2008, 2012, 2016, 2019
Step 1) 오류 페이지 설정 편집
제어판> 관리도구> IIS(인터넷 정보 서비스) 관리자> 해당 웹 사이트> [오류 페이지]
> [작업] 탭에서 [기능 설정 편집]> “서버오류 발생 시 다음 반환“ 항목을 ”사용자
지정 오류 페이지“로 설정
---
W-60 (중) 2. 서비스 관리 > 2.28 SNMP 서비스 구동 점검
취약점 개요
점검내용  SNMP 서비스 구동 여부 점검
점검목적
 취약한 SNMP 서비스를 비활성화 하여 시스템의 주요정보 유출 및 불법수
정을 방지하기 위함
보안위협
 취약한 SNMP 서비스를 사용하는 경우 서비스거부공격(DoS, DDoS), 버퍼
오버플로우, 비인가 접속 등의 공격의 위험이 있음
참고
※ SNMP: SNMP(Simple Network Management Protocol)는 MIB(Management Information Ba
se)에 기반한 네트워크 망을 관리하기 위한 목적으로 만들어진 프로토콜로, 간단한 명령으
로 원격 시스템의 CPU정보에서부터, 인터페이스 트래픽량 등 여러 가지 정보를 확인 가능
점검대상 및 판단기준
대상  Windows 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : SNMP 서비스를 사용하지 않는 경우
취약 : SNMP 서비스를 사용하는 경우
조치방법 불필요 시 서비스 중지/사용 안 함
점검 및 조치 사례
■ Windows 2000, 2003, 2008, 2012, 2016, 2019
Step 1) 불필요 시 해당 서비스 제거
시작> 실행> SERVICES.MSC> SNMP Service(또는, SNMP 서비스)> 속성에서 “시작
유형”을 “사용 안 함”으로 설정한 후, SNMP 서비스를 중지함
조치 시
영향
NMS 또는, 별도의 툴에서 SNMP 서비스를 이용하여 서버를 모니터링 하는 경
우, 통신하고자 하는 Server/Client에 모두 같은 Community String을 사용하여
야 함(서비스> SNMP> 등록 정보> 종속성 참고)
※ NMS(Network Management System): 네트워크 관리 시스템
---
W-61 (중) 2. 서비스 관리 > 2.29 SNMP 서비스 커뮤니티스트링의 복잡성 설정
취약점 개요
점검내용  SNMP 서비스 커뮤니티 스트링(Community String) 적절성 점검
점검목적
 SNMP에서 일종의 패스워드로 사용하는 Community String을 유추할 수 없
는 복잡한 값으로 변경하여 불필요한 시스템 정보 노출을 차단하기 위함
보안위협
 Community String 설정을 변경하지 않고 public, private 등 Default 설정 값
으로 사용하는 경우, 기본 String 값을 통한 시스템의 주요 정보 및 설정 상
태의 비인가자 노출 위험이 존재
참고 -
점검대상 및 판단기준
대상  Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : SNMP 서비스를 사용하지 않거나 Community String이 public, private이
아닌 경우
취약 : SNMP 서비스를 사용하며, Community String이 public, private인 경우
조치방법 불필요 시 서비스 중지/사용 안 함, 사용 시 Default Community String 변경
점검 및 조치 사례
■ Windows NT
Step 1) 바탕화면> 네트워크 환경> 등록 정보> 서비스/SNMP Service> 등록 정보> 보안
■ Windows 2000, 2003, 2008, 2012, 2016, 2019
Step 1) 시작> 실행> SERVICES.MSC> SNMP Service(또는, SNMP 서비스)> 속성> 보안>
[인증 트랩 보내기] 아래 [추가] 버튼>
Step 2) [SNMP 서비스 구성]> 쓰기 권한이 필요하지 않다면 커뮤니티 이름을 읽기 전용으로
Public/Private이 아닌 이름을 추가(NT의 경우 시작> 제어판> 서비스에서 설정)
Step 3) 불필요 시 해당 서비스 제거
시작> 실행> SERVICES.MSC> SNMP Service(또는, SNMP 서비스)> 속성 [일반]
탭에서 “시작 유형”을 “사용 안 함”으로 설정한 후, SNMP 서비스 중지
조치 시
영향
NMS 또는, 별도의 툴에서 SNMP 서비스를 이용하여 서버를 모니터링 하는 경
우, 통신하고자 하는 Server/Client에 모두 같은 Community String을 사용하여
야 함.(서비스> SNMP> 등록 정보> 종속성 참고)
---
W-62 (중) 2. 서비스 관리 > 2.30 SNMP Access control 설정
취약점 개요
점검내용  SNMP 패킷 접근 제어 설정 여부 점검
점검목적
 SNMP 트래픽에 대한 접근 제어 설정을 하여 내부 네트워크로부터의 악의
적인 공격을 차단하기 위함
보안위협
 SNMP Access control 설정을 적용하지 않아 인증되지 않은 내부 서버로부
터의 SNMP 트래픽을 차단하지 않을 경우, 장치 구성 변경, 라우팅 테이블
조작, 악의적인 TFTP 서버 구동 등의 SNMP 공격에 노출될 수 있음
참고
※ SNMP(v1, v2c)에서 클라이언트와 데몬간의 get_request(요청)와 get_response(응답) 과
정은 암호화가 아닌 평문으로 전송되므로 스니핑(sniffing)이 가능함
※ SNMP v3의 경우 인증을 위해 암호화가 제공
점검대상 및 판단기준
대상  Windows 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : 특정 호스트로부터 SNMP 패킷 받아들이기로 설정되어 있는 경우
취약 : 모든 호스트로부터 SNMP 패킷 받아들이기로 설정되어 있는 경우
조치방법 불필요 시 서비스 중지/사용 안 함, 사용 시 SNMP 패킷 수령 호스트 지정
점검 및 조치 사례
■ Windows 2000, 2003, 2008, 2012, 2016, 2019
Step 1) 시작> 실행> SERVICES.MSC> SNMP Service(또는, SNMP 서비스)> 속성> 보안
Step 2) “인증 트랩 보내기” 및 “다음 호스트로부터 SNMP 패킷 받아들이기” 선택
Step 3) SNMP 호스트 등록
---
W-63 (중) 2. 서비스 관리 > 2.31 DNS 서비스 구동 점검
취약점 개요
점검내용  DNS 서비스의 동적 업데이트 설정 여부 점검
점검목적
 DNS 동적 업데이트를 비활성화 함으로 신뢰할 수 없는 원본으로부터 업데
이트를 받아들이는 위험을 차단하기 위함
보안위협
 DNS 서버에서 동적 업데이트를 사용할 경우 악의적인 사용자에 의해 신뢰
할 수 없는 데이터가 받아들여질 위험이 존재함
참고
※ 동적 업데이트: DNS 정보에 변경 사항이 있을 때마다 DNS 클라이언트 컴퓨터가 자신
의 리소스 레코드(zone 파일)를 DNS 서버에 자동으로 업데이트하는 기능으로 영역 레
코드 수동 관리 작업을 줄일 수 있음
점검대상 및 판단기준
대상  Windows 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : DNS 서비스를 사용하지 않거나 동적 업데이트 “없음(아니오)”으로 설정
되어 있는 경우
취약 : 서비스를 사용하며 동적 업데이트가 설정되어 있는 경우
조치방법 일반적으로 동적 업데이트 기능이 필요 없으나 확인 필요
점검 및 조치 사례
■ Windows 2000, 2003, 2008, 2012, 2016, 2019
Step 1) 시작> 실행> DNSMGMT.MSC> 각 조회 영역> 해당 영역> 속성> 일반
Step 2) 동적 업데이트 → 없음(또는, 아니오) 선택
Step 3) 불필요 시 해당 서비스 제거
시작> 실행> SERVICES.MSC> DNS 서버> 속성 [일반] 탭에서 "시작 유형"을 "사용
안 함"으로 설정한 후, DNS 서비스 중지
---
W-64 (하) 2. 서비스 관리 > 2.32 HTTP/FTP/SMTP 배너 차단
취약점 개요
점검내용  HTTP/FTP/SMTP 서비스 배너 차단 적용 여부 점검
점검목적
 HTTP/FTP/SMTP 서비스 접속 배너를 통한 불필요한 정보 노출을 방지하기
위함
보안위협
 서비스 접속 배너가 차단되지 않은 경우 임의의 사용자가 HTTP, FTP, SMTP
접속 시도 시 노출되는 접속 배너 정보를 수집하여 악의적인 공격에 이용할
수 있음
참고 -
점검대상 및 판단기준
대상  Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : HTTP, FTP, SMTP 접속 시 배너 정보가 보이지 않는 경우
취약 : HTTP, FTP, SMTP 접속 시 배너 정보가 보여지는 경우
조치방법 사용하지 않는 경우 IIS 서비스 중지/사용 안 함, 사용 시 속성 값 수정
점검 및 조치 사례
■ HTTP
[ Server 헤더 제거 ]
Step 1) Microsoft 다운로드 센터에서 URL Rewrite 다운로드 후 설치
https://www.iis.net/downloads/microsoft/url-rewrite
Step 2) 제어판> 관리도구> IIS(인터넷 정보 서비스) 관리자> 해당 웹 사이트> [URL 재작성]
Step 3) 작업 탭> [서버 값 관리 – 서버 변수 보기...]
Step 4) 작업 탭> [추가...]> 서버 변수 추가
- 서버 변수 이름: RESPONSE_SERVER
Step 5) [URL 재작성]> 작업 탭> [규칙 추가...]> 아웃바운드 규칙> 빈 규칙
Step 6) 이름, 검색 범위, 변수 이름, 패턴 설정> 적용
- 이름(N): Remove Server
- 검색 범위: 서버 변수
- 변수 이름: RESPONSE_SERVER
- 패턴(T): .*
[ X-Powered-By 헤더 제거 ]
Step 1) 제어판> 관리도구> IIS(인터넷 정보 서비스) 관리자> 해당 웹 사이트> [HTTP 응답 헤더]
Step 2) [X-Powered-By] 설정 제거
■ FTP
Step 1) IIS(인터넷 정보 서비스) 관리자 > FTP 메시지> 기본 배너 숨기기 설정
■ SMTP
Step 1) 시작> 실행> cmd> adsutil.vbs 파일이 있는 디렉터리로 이동
- 명령어: cd C:\inetpub\AdminScripts
- adsutil.vbs를 사용하기 위해 서버 관리자에서 역할 추가 필요 → ”웹 서버(IIS)>
관리 도구> IIS 6 관리 호환성> IIS 6 스크립팅 도구“ 설치 필요
Step 2) IIS에서 서비스 중인 SMTP 서비스 목록 확인
- 명령어: cscript adsutil.vbs enum /p smtpsvc
Step 3) SMTP 서비스에 connectresponse 속성 값에서 배너 문구 수정
- 명령어: cscript adsutil.vbs set smtpsvc/1/connectresponse “Banner Text”
Step 4) SMTP 서비스 재시작
- 명령어: net stop smtpsvc (중지)
- 명령어: net start smtpsvc (시작)
---
W-65 (중) 2. 서비스 관리 > 2.33 Telnet 보안 설정
취약점 개요
점검내용  Telnet 서비스 구동 비활성화 및 취약한 인증 사용 여부 점검
점검목적
 취약 프로토콜인 Telnet 서비스의 사용을 원칙적으로 금지하고, 부득이 이용
할 경우 네트워크상으로 패스워드를 전송하지 않는 NTLM 인증을 사용하도
록 하여 인증 정보의 노출을 차단하기 위함
보안위협
 Telnet 서비스는 평문으로 데이터를 송수신하기 때문에 Password 방식으로
인증을 수행할 경우 ID 및 Password가 외부로 노출될 위험성이 있음
참고
※ Windows 서버의 Telnet 서비스의 두 가지 인증 방법
• NTLM 인증: 암호를 전송하지 않고 negotiate/challenge/response 절차로 인증 수행
• Password 인증: 관리자 및 Telnet Clients 그룹에 포함된 ID/PW로 인증 수행
※ 기반시설 시스템에서 Telnet 서비스의 이용은 원칙적으로 금지하나, 조직에서 부득이
유사 기능을 활용해야 하는 경우 SSH를 사용하는 것을 권고함
※ Windows 2016 이상 버전에서는 보안상 이슈로 인해 Telnet 서버 설치 제공하지 않음
점검대상 및 판단기준
대상  Windows NT, 2000, 2003, 2008, 2012
판단기준
양호 : Telnet 서비스가 구동 되어 있지 않거나 인증 방법이 NTLM인 경우
취약 : Telnet 서비스가 구동 되어 있으며 인증 방법이 NTLM이 아닌 경우
조치방법 불필요 시 서비스 중지/사용 안 함 설정, 사용 시 인증 방법으로 NTLM만 사용
점검 및 조치 사례
■ Windows NT, 2000
Step 1) 시작> 설정> 제어판> 관리 도구> 텔넷 서버 설정
Step 2) NTLM 인증 방식만 사용
■ Windows 2003, 2008, 2012
Step 1) 시작> 실행> cmd> tlntadmn config
Step 2) tlntadmn config sec = +NTLM -passwd (passwd 인증 방식을 제외하고 NTLM
인증 방식만 사용)
Step 3) 불필요 시 해당 서비스 제거
시작> 실행> SERVICES.MSC> Telnet> 속성 [일반] 탭에서 "시작 유형"을 "사용 안 함
"으로 설정한 후 Telnet 서비스 중지
조치 시
영향
일반적인 경우 영향 없음
---
W-66 (중) 2. 서비스 관리 > 2.34 불필요한 ODBC/OLE-DB 데이터 소스와 드라이브 제거
취약점 개요
점검내용  불필요한 ODBC/OLE-DB 데이터 소스와 드라이브 제거 여부 점검
점검목적
 불필요한 데이터 소스 및 드라이버를 ODBC 데이터 소스 관리자 도구를 이
용해 제거하여 비인가자에 의한 데이터베이스 접속 및 자료 유출을 차단하
기 위함
보안위협
 불필요한 ODBC/OLE-DB 데이터 소스를 통한 비인가자에 의한 데이터베이스
접속 및 자료 유출 위험 존재
참고
※ 특정 샘플 애플리케이션은 샘플 데이터베이스를 위해 ODBC 데이터 소스를 설치하거
나 불필요한 ODBC/OLE-DB 데이터베이스 드라이버를 설치하므로 불필요한 데이터 소
스나 드라이버는 ODBC 데이터 소스 관리자 도구를 이용해서 제거하는 것이 바람직함
점검대상 및 판단기준
대상  Windows NT, 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : 시스템 DSN 부분의 Data Source를 현재 사용하고 있는 경우
취약 : 시스템 DSN 부분의 Data Source를 현재 사용하고 있지 않은 경우
조치방법 사용하지 않는 불필요한 ODBC 데이터 소스 제거
점검 및 조치 사례
■ Windows NT
Step 1) 시작> 설정> 제어판> 데이터 원본(ODBC)> 시스템 DSN> 해당 드라이브 클릭
Step 2) 사용하지 않은 데이터 소스 제거
■ Windows 2000, 2003, 2008, 2012, 2016, 2019
Step 1) 시작> 설정> 제어판> 관리 도구> ODBC 데이터 원본> 시스템 DSN> 해당 드라이브 클릭
Step 2) 사용하지 않는 데이터 소스 제거
---
W-67 (중) 2. 서비스 관리 > 2.35 원격터미널 접속 타임아웃 설정
취약점 개요
점검내용  원격터미널 접속 타임아웃 설정 여부 점검
점검목적
 조직에서 부득이 원격터미널 접속을 허용해야 할 경우, 원격터미널 접속 후
일정 시간 동안 이벤트가 발생하지 않은 호스트의 접속을 차단하여 비인가
자의 불필요한 접근을 차단하고 정보의 노출을 방지하기 위함
보안위협
 접속 타임아웃 값이 설정되지 않은 경우 유휴 시간 내 비인가자의 시스템
접근으로 인해 불필요한 내부 정보의 노출 위험이 존재함
참고
※ 기반시설 시스템에서 원격 터미널 서비스의 이용은 원칙적으로 금지하나, 부득이 해당 기
능을 활용해야 하는 경우 접속 타임아웃 설정 등의 보안 조치를 반드시 적용하여야 함
점검대상 및 판단기준
대상  Windows 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : 원격제어 시 Timeout 제어 설정을 적용한 경우
취약 : 원격제어 시 Timeout 제어 설정을 적용하지 않은 경우
조치방법 Timeout 제어 설정 적용
점검 및 조치 사례
■ Windows 2000, 2003, 2008
Step 1) 시작> 실행> 열기> TSCC.MSC 실행(Windows 2008은 TSCONFIG.MC)
Step 2) RDP-Tcp connection에서 우클릭> 속성 실행
Step 3) [세션] 탭에서 아래 Override user settings(사용자 설정 무시)을 체크하고 Idle session
time 세션이 끊어지도록(유휴 세션 제한) 원하는 시간을 설정함
■ Windows 2012, 2016, 2019
Step 1) 시작> 실행> GPEDIT.MSC(로컬 그룹 정책 편집기)
Step 2) 컴퓨터 구성> 관리 템플릿> Windows 구성 요소> 터미널 서비스> 원격 데스크톱
세션 호스트> 세션 시간 제한>
Step 3) [활성 상태지만 유휴 터미널 서비스 세션에 시간 제한 설정]> [유휴 세션 제한]을
30분으로 설정
---
W-68 (중) 2. 서비스 관리 > 2.36 예약된 작업에 의심스러운 명령이 등록되어 있는지 점검
취약점 개요
점검내용  예약된 작업에 의심스러운 명령의 등록 여부 점검
점검목적
 외부 무단 침입 시 설정될 수 있는 불필요한 예약 작업의 등록 여부를 확인
하기 위함
보안위협
 일정 시간마다 미리 설정해둔 프로그램을 실행할 수 있는 예약된 작업은 시
작프로그램과 더불어서 해킹과 트로이 목마, 백도어를 설치하여 공격하기 좋
은 루트로 사용될 수 있음
참고 -
점검대상 및 판단기준
대상  Windows 2000, 2003, 2008, 2012, 2016, 2019
판단기준
양호 : 불필요한 명령어나 파일 등 주기적인 예약 작업의 존재 여부를 주기적으
로 점검하고 제거한 경우
취약 : 불필요한 명령어나 파일 등 주기적인 예약 작업의 존재 여부를 주기적으
로 점검하지 않거나, 해당 작업을 제거하지 않은 경우
조치방법 예약 작업에 대한 주기적인 확인
점검 및 조치 사례
■ Windows 2000, 2003, 2008, 2012, 2016, 2019
< GUI 확인 방법 >
Step 1) 시작> 설정> 제어판> 예약된 작업 확인
※ 2008, 2012, 2016, 2019 는 제어판> 관리도구> 작업 스케줄러 에서 확인
Step 2) 등록된 예약 작업을 선택하여 상세내역 확인
Step 3) 불필요한 파일 존재 시 삭제
< CLI 확인 방법 >
Step 1) 시작> 실행> cmd 입력
Step 2) cmd 창에서 C:\>at 명령어를 실행하여 확인
※ 2012, 2016, 2019 는 schtasks 명령어로 확인
---
